FROM opensuse/leap:15.2.1
RUN ln -s /usr/sbin/update-alternatives /usr/bin
RUN zypper ar -f -c http://download.opensuse.org/tumbleweed/repo/oss/ tumbleweed \
&& zypper mr -p 1 tumbleweed \
&& zypper -n --gpg-auto-import-keys refresh \
&& zypper -n --gpg-auto-import-keys install --repo tumbleweed \
  blas-devel \
  lapack-devel \
  python3 \
  python3-Cython \
  python3-numpy \
  python3-numpy-devel \
  python3-scipy \
  python3-pip \
  python3-setuptools \
  python3-h5py \
&& zypper -n --gpg-auto-import-keys install \
  ccache \
  cmake \
  curl \
  fftw3-devel \
  gcc-c++ \
  gdb \
  git \
  hdf5-openmpi2-devel-static \
  libboost_serialization1_66_0-devel libboost_mpi1_66_0-devel libboost_filesystem1_66_0-devel libboost_test1_66_0-devel \
  libhdf5-103-openmpi2 \
  Modules \
  openmpi2 \
  vim \
  which \
  zlib-devel-static
RUN /usr/sbin/useradd -m espresso
USER 1000
WORKDIR /home/espresso
